# ComfyUI String Tools

這是一個 ComfyUI 的客製化節點擴充包，包含強大的動態字串處理功能，特別針對提示詞 (Prompt) 編輯進行了高度優化。

## Dynamic String Combiner (動態字串合併器)

這個節點不僅允許你合併多個字串，更透過全新的 **Dynamic Chips UI** 帶來現代化的操作體驗。

### 核心功能

*   **多輸入支援**：支援最多 10 個字串輸入 (`string_1` 到 `string_10`)，可自由合併。
*   **動態連結**：支援將輸入框轉為接點 (Convert to input)，與其他節點串接。
*   **自訂分隔符**：透過 `delimiter` 設定合併時的分隔符號（預設為逗號 `,`）。
*   **智慧過濾**：`remove_empty` 選項可自動移除空白並忽略空值，保持輸出整潔。

### 🌟 Dynamic Chips UI (互動式標籤介面)

我們為字串輸入框導入了全新的互動介面，讓管理提示詞或參數更加直覺：

*   **自動轉換 (Text to Chips)**：
    *   輸入文字後按下 `Enter` 或點擊外部 (Blur)，內容會自動轉換為 Chip。
    *   支援批次輸入：若輸入 `cat, dog, bird`，會自動切分為三個獨立的 Chip。
*   **權重調整 (Weight Adjustment)**：
    *   將滑鼠停留在 Chip 上，滾動 **滑鼠滾輪** 即可增加或減少權重。
    *   自動套用 ComfyUI 權重格式 `(text:1.1)`。
    *   若權重為 1.0，會自動簡化為原始文字。
*   **拖曳重排 (Drag & Drop)**：
    *   **直覺排序**：可隨意拖曳 Chip 改變順序。
    *   **跨輸入框移動**：支援將 Chip 從一個輸入框拖曳到另一個輸入框。
    *   **精準插入**：提供視覺化的插槽 (Placeholder) 動畫，明確指示插入位置，支援多行複雜排版。
*   **編輯與管理**：
    *   **雙擊編輯**：對 Chip 點擊兩下即可修改內容。
    *   **一鍵清除**：輸入框右上方提供 `×` 按鈕，可快速清除所有內容。
*   **流暢體驗**：
    *   包含 Hover 上浮、點擊回饋與流暢的過渡動畫，操作手感極佳。

### 🚀 智慧標籤自動完成 (Smart Tag Autocomplete)

這不只是一個輸入框，而是一個強大的標籤搜尋引擎：

*   **雙語搜尋**：支援 **英文** 與 **中文** 關鍵字搜尋。
    *   輸入 "girl" 會找到 "1girl", "girl", "little_girl"...
    *   輸入 "女孩" 也會找到 "1girl (1女孩)", "little_girl (小女孩)"...
*   **即時預覽**：
    *   搜尋結果會同時顯示英文標籤與中文翻譯 (例如：`1girl (1女孩)`)。
    *   建立 Chip 後，畫面上也會保留中文翻譯，方便直覺辨識。
*   **鍵盤導航**：
    *   支援 `↑` `↓` 鍵選擇候選詞。
    *   按下 `Enter` 或 `Tab` 快速建立標籤。
    *   選單會自動捲動跟隨目前的焦點。
*   **智慧防遮擋**：輸入框與選單層級經過精心調整，確保不會遮擋 ComfyUI 的其他重要元件 (如節點搜尋框)，同時若節點縮小 (Collapse) 會自動隱藏以保持畫面整潔。

### ⚙️ 必要的設定檔案

為了啟用自動完成功能，請確保 **tags.json** 位於正確位置：
`custom_nodes/string-tools/js/tags.json`

> 該檔案包含了標籤資料庫，格式需為 JSON Array。


### 輸入參數說明

*   **delimiter (STRING)**: 用來連接字串的分隔符號。例如 `,`、` ` (空格) 或 `\n` (換行)。
*   **remove_empty (BOOLEAN)**:
    *   `True` (預設): 自動刪除字串前後的空白 (strip)，並且**只合併有內容**的字串。
    *   `False`: 保留原始字串內容。
*   **string_1 ~ string_10 (STRING)**: 要合併的文字內容，支援 Chip 操作。

### 輸出說明

*   **combined_string (STRING)**: 合併處理後的最終字串。

### 安裝方式

請確保此資料夾位於你的 ComfyUI `custom_nodes` 目錄下：
`ComfyUI/custom_nodes/string-tools/`

---
Made for ComfyUI.
